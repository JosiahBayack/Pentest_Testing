import socket
import os

targetIP = input("Enter target IP address: ")
port = int(input("Enter port numnber: "))

def printmenu(): #creates menu for use while connected
    print("\n0) Close the connection", "\n",
    "1) Get System info", "\n", "2) List Directories")

s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
s.connect ((targetIP, port)) #establish connection to IP and port

print ("Connection established", "\n")
printmenu()

while (1):
    message = input ("\n-Choose and option: ")

    if(message == '0'): #closes connection if user enters 0
        s.sendall (message.encode())
        s.close()
        break

    elif (message == '1'): #tells user what OS the target is using
        s.sendall (message.encode())
        data = s.recv(1024)
        if not data: break
        print(data.decode('utf-8'))

    elif (message == '2'): #reads all files in directory and returns to user
        path = input ("Insert path: ")
        s.sendall (message.encode())
        s.sendall (path.encode())
        data = s.recv (1024)
        data = data.decode ('utf-8').split(",")
        print ("*"*40)
        for x in data:
            print (x)
        print("*"*40)

    printmenu()
